<section data-controller="modal" id="<%=dom_id(menu_item)%>">
  <button type=button
          data-action="click->modal#open"
          class="flex items-start gap-2 p-2 px-4 w-full rounded-lg border-2 border-stone-600">
    <h4 class="text-stone-300">
      <%= menu_item.meal.name %>
    </h4>
    <% unless menu_item.meal.meal_type.nil? %>
      <div class="flex gap-2 px-2 ml-auto rounded-lg bg-stone-700 border text-sm" style="border-color: <%= menu_item.meal.meal_type.color_style or "gray" %>">
        <span style="color: <%= menu_item.meal.meal_type.color_style or "gray" %>">
          <%= menu_item.meal.meal_type.name %>
        </span>
      </div>
    <% end %>
  </button>

  <dialog data-modal-target="modal"
          data-action="click->modal#close"
          class="fixed top-0 w-[100vw] h-[100vh] bg-transparent backdrop-brightness-50 backdrop-blur-md z-10">
    <div class="container mx-auto m-4 rounded-lg bg-stone-900/50"
      data-controller="clickCapture"
      data-action="click->clickCapture#stopPropagation"
    >
      <header class="flex gap-4 mb-4 items-end border-b-2 border-stone-600 py-2 px-4">
        <p class="text-stone-400"><%= menu_item.meal.name %> in <%= menu_item.restaurant.name %> on <%= menu_item.menu_date %></p>
        <button type="button" class="hidden md:block ml-auto text-stone-200" data-action="click->modal#close">Close</button>
      </header>
      <article class="p-4">
        <%= turbo_frame_tag "meal_details", src: menu_item.meal, loading: "lazy" do %>
          <p class="text-stone-200 p-4">Loading details...</p>
        <% end %>
        <%= turbo_frame_tag "user_rating", src: user_rating_meal_path(menu_item.meal), loading: "lazy" do %>
          <p class="text-stone-200 p-4">Loading rating...</p>
        <% end %>
      </article>
      <button type="button" class="md:hidden mt-auto w-full py-2 border-t-2 border-teal-700 text-teal-600" data-action="click->modal#close">Close</button>
    </div>
  </dialog>
</section>